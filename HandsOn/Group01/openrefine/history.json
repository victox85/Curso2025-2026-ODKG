[
  {
    "op": "core/column-removal",
    "columnName": "PK",
    "description": "Eliminar columna PK"
  },
  {
    "op": "core/column-removal",
    "columnName": "CONTENT-URL",
    "description": "Eliminar columna CONTENT-URL"
  },
  {
    "op": "core/column-removal",
    "columnName": "ORIENTACION",
    "description": "Eliminar columna ORIENTACION"
  },
  {
    "op": "core/column-removal",
    "columnName": "ESCALERAS",
    "description": "Eliminar columna ESCALERAS"
  },
  {
    "op": "core/column-removal",
    "columnName": "PUERTA",
    "description": "Eliminar columna PUERTA"
  },
  {
    "op": "core/column-removal",
    "columnName": "PLANTA",
    "description": "Eliminar columna PLANTA"
  },
  {
    "op": "core/column-removal",
    "columnName": "CLASE-VIAL",
    "description": "Eliminar columna CLASE-VIAL"
  },
  {
    "op": "core/column-removal",
    "columnName": "TIPO-NUM",
    "description": "Eliminar columna TIPO-NUM"
  },
  {
    "op": "core/column-removal",
    "columnName": "COD-BARRIO",
    "description": "Eliminar columna COD-BARRIO"
  },
  {
    "op": "core/column-removal",
    "columnName": "COD-DISTRITO",
    "description": "Eliminar columna COD-DISTRITO"
  },
  {
    "op": "core/column-removal",
    "columnName": "COORDENADA-X",
    "description": "Eliminar columna COORDENADA-X"
  },
  {
    "op": "core/column-removal",
    "columnName": "COORDENADA-Y",
    "description": "Eliminar columna COORDENADA-Y"
  },
  {
    "op": "core/column-removal",
    "columnName": "FAX",
    "description": "Eliminar columna FAX"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "LOCALIDAD",
    "expression": "value",
    "edits": [
      {
        "from": [
          "MADRID",
          "MADRID 28042",
          "Madrid"
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "MADRID"
      }
    ],
    "description": "Editar celdas en masa en columna LOCALIDAD"
  },
  {
    "op": "core/text-transform",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "TIPO",
          "expression": "value",
          "columnName": "TIPO",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [],
          "selectBlank": true,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "columnName": "TIPO",
    "expression": "grel:if(value == null, \"/contenido/entidadesYorganismos/ParquesJardines\", value)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10,
    "description": "Transforma el texto de las celdas en la columna TIPO usando la expresión grel:if(value == null, \"/contenido/entidadesYorganismos/ParquesJardines\", value)"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "baseColumnName": "TIPO",
    "expression": "grel:value.replace(\"/contenido/entidadesYorganismos/\", \"\").split(\"/\")[0]",
    "onError": "set-to-blank",
    "newColumnName": "TipoInstalacion",
    "columnInsertIndex": 19,
    "description": "Crear la columna TipoInstalacion en el índice 19 basada en la columna TIPO usando la expresión grel:value.replace(\"/contenido/entidadesYorganismos/\", \"\").split(\"/\")[0]"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "TELEFONO",
          "expression": "value",
          "columnName": "TELEFONO",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "630 630 710 (actividades) \n917210079 (de lunes a viernes de 9 a 14 h)",
                "l": "630 630 710 (actividades) \n917210079 (de lunes a viernes de 9 a 14 h)"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "columnName": "TELEFONO",
    "expression": "value",
    "edits": [
      {
        "from": [
          "630 630 710 (actividades) \n917210079 (de lunes a viernes de 9 a 14 h)"
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "630 630 710\n917 210 079"
      }
    ],
    "description": "Editar celdas en masa en columna TELEFONO"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "TELEFONO",
    "expression": "value",
    "edits": [
      {
        "from": [
          "913 553 201 -  919 246 793"
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "913 553 201 / 919 246 793"
      }
    ],
    "description": "Editar celdas en masa en columna TELEFONO"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "TELEFONO",
    "expression": "value",
    "edits": [
      {
        "from": [
          "913 947 505 / 913 947 504 (incidencias matrícula)"
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "913 947 505 / 913 947 504"
      }
    ],
    "description": "Editar celdas en masa en columna TELEFONO"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "TELEFONO",
    "expression": "value",
    "edits": [
      {
        "from": [
          "914 305 871 - Taquilla 915 288 879"
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "914 305 871 / 915 288 879"
      }
    ],
    "description": "Editar celdas en masa en columna TELEFONO"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "TELEFONO",
    "expression": "value",
    "edits": [
      {
        "from": [
          "914 507 344 - 914 505 530"
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "914 507 344 / 914 505 530"
      }
    ],
    "description": "Editar celdas en masa en columna TELEFONO"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "TELEFONO",
    "expression": "value",
    "edits": [
      {
        "from": [
          "914 800 476 - idmlavaguada@madrid.es"
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "914 800 476"
      }
    ],
    "description": "Editar celdas en masa en columna TELEFONO"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "TELEFONO",
    "expression": "value",
    "edits": [
      {
        "from": [
          "917 106 155 (De L a V de 9 a 22 horas)"
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "917 106 155"
      }
    ],
    "description": "Editar celdas en masa en columna TELEFONO"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "TELEFONO",
    "expression": "value",
    "edits": [
      {
        "from": [
          "917 588 677 - 915 592 090 - 649 84 14 45"
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "917 588 677 / 915 592 090 / 649 84 14 45"
      }
    ],
    "description": "Editar celdas en masa en columna TELEFONO"
  },
  {
    "op": "core/text-transform",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "TELEFONO",
    "expression": "grel:value.replace(/\\s*\\/\\s*/,\"\\n\").replace(/\\s+-\\s+/,\"\\n\")",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10,
    "description": "Transforma el texto de las celdas en la columna TELEFONO usando la expresión grel:value.replace(/\\s*\\/\\s*/,\"\\n\").replace(/\\s+-\\s+/,\"\\n\")"
  },
  {
    "op": "core/text-transform",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "TELEFONO",
    "expression": "grel:value.replace(/[^0-9\\n]+/, \"\").replace(/[^0-9\\n]+/, \"\").replace(/[^0-9\\n]+/, \"\")",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10,
    "description": "Transforma el texto de las celdas en la columna TELEFONO usando la expresión grel:value.replace(/[^0-9\\n]+/, \"\").replace(/[^0-9\\n]+/, \"\").replace(/[^0-9\\n]+/, \"\")"
  },
  {
    "op": "core/text-transform",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "TELEFONO",
    "expression": "grel:value.replace(/(\\d{9})(?=\\d)/, \"$1\\n\")",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10,
    "description": "Transforma el texto de las celdas en la columna TELEFONO usando la expresión grel:value.replace(/(\\d{9})(?=\\d)/, \"$1\\n\")"
  },
  {
    "op": "core/text-transform",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "ACCESIBILIDAD",
    "expression": "grel:if(\n  isBlank(value),\n  \"\",\n  forEach(\n    value.split(/[,; ]+/),\n    v,\n    if(v==\"0\",\"No accesible\",\n      if(v==\"1\",\"Accesible\",\n        if(v==\"2\",\"Instalación parcialmente accesible para personas con movilidad reducida\",\n          if(v==\"3\",\"Sin información sobre accesibilidad para personas con movilidad reducida\",\n            if(v==\"4\",\"Lengua de signos\",\n              if(v==\"5\",\"Señalización podotáctil\",\n                if(v==\"6\",\"Bucle de inducción magnético\",\"\")\n              )\n            )\n          )\n        )\n      )\n    )\n  ).join(\"\\n\")\n)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10,
    "description": "Transforma el texto de las celdas en la columna ACCESIBILIDAD usando la expresión grel:if(\n  isBlank(value),\n  \"\",\n  forEach(\n    value.split(/[,; ]+/),\n    v,\n    if(v==\"0\",\"No accesible\",\n      if(v==\"1\",\"Accesible\",\n        if(v==\"2\",\"Instalación parcialmente accesible para personas con movilidad reducida\",\n          if(v==\"3\",\"Sin información sobre accesibilidad para personas con movilidad reducida\",\n            if(v==\"4\",\"Lengua de signos\",\n              if(v==\"5\",\"Señalización podotáctil\",\n                if(v==\"6\",\"Bucle de inducción magnético\",\"\")\n              )\n            )\n          )\n        )\n      )\n    )\n  ).join(\"\\n\")\n)"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "baseColumnName": "TRANSPORTE",
    "expression": "grel:if((value.match(/.*(autobuses|bus|autobús).*/i)!=null),value,null)",
    "onError": "set-to-blank",
    "newColumnName": "Bus",
    "columnInsertIndex": 5,
    "description": "Crear la columna Bus en el índice 5 basada en la columna TRANSPORTE usando la expresión grel:if((value.match(/.*(autobuses|bus|autobús).*/i)!=null),value,null)"
  },
  {
    "op": "core/text-transform",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "Bus",
    "expression": "grel:if(\n\t\t  value.match(/.*((autobuses|bus|autobús).*)/i) != null,\n\t\t  value.match(/.*((autobuses|bus|autobús).*)/i)[0].split(/[\\.\\n]|metro|servicio|bicicleta|cercanías|renfe|tren|acceso|también/i)[0].trim(),\n\t\t  null\n\t\t)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10,
    "description": "Transforma el texto de las celdas en la columna Bus usando la expresión grel:if(\n\t\t  value.match(/.*((autobuses|bus|autobús).*)/i) != null,\n\t\t  value.match(/.*((autobuses|bus|autobús).*)/i)[0].split(/[\\.\\n]|metro|servicio|bicicleta|cercanías|renfe|tren|acceso|también/i)[0].trim(),\n\t\t  null\n\t\t)"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "baseColumnName": "TRANSPORTE",
    "expression": "grel:if((value.match(/.*(metro).*/i)!=null),value,null)",
    "onError": "set-to-blank",
    "newColumnName": "Metro",
    "columnInsertIndex": 5,
    "description": "Crear la columna Metro en el índice 5 basada en la columna TRANSPORTE usando la expresión grel:if((value.match(/.*(metro).*/i)!=null),value,null)"
  },
  {
    "op": "core/text-transform",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "Metro",
    "expression": "grel:if(\n\t\t  value.match(/.*((metro).*)/i) != null,\n\t\t  value.match(/.*((metro).*)/i)[0].split(/[\\.\\n]|autobuses|bus|autobús|servicio|bicicleta|cercanías|renfe|tren|acceso|también/i)[0].trim(),\n\t\t  null\n\t\t)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10,
    "description": "Transforma el texto de las celdas en la columna Metro usando la expresión grel:if(\n\t\t  value.match(/.*((metro).*)/i) != null,\n\t\t  value.match(/.*((metro).*)/i)[0].split(/[\\.\\n]|autobuses|bus|autobús|servicio|bicicleta|cercanías|renfe|tren|acceso|también/i)[0].trim(),\n\t\t  null\n\t\t)"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "baseColumnName": "TRANSPORTE",
    "expression": "grel:if((value.match(/.*(cercanías|renfe|tren).*/i)!=null),value,null)",
    "onError": "set-to-blank",
    "newColumnName": "Cercanias",
    "columnInsertIndex": 5,
    "description": "Crear la columna Cercanias en el índice 5 basada en la columna TRANSPORTE usando la expresión grel:if((value.match(/.*(cercanías|renfe|tren).*/i)!=null),value,null)"
  },
  {
    "op": "core/text-transform",
    "engineConfig": {
      "facets": [],
      "mode": "row-based"
    },
    "columnName": "Cercanias",
    "expression": "grel:if(\n\t\t  value.match(/.*((cercanías|renfe|tren).*)/i) != null,\n\t\t  value.match(/.*((cercanías|renfe|tren).*)/i)[0].split(/[\\.\\n]|metro|servicio|bicicleta|autobuses|bus|autobús|acceso|también/i)[0].trim(),\n\t\t  null\n\t\t)",
    "onError": "keep-original",
    "repeat": false,
    "repeatCount": 10,
    "description": "Transforma el texto de las celdas en la columna Cercanias usando la expresión grel:if(\n\t\t  value.match(/.*((cercanías|renfe|tren).*)/i) != null,\n\t\t  value.match(/.*((cercanías|renfe|tren).*)/i)[0].split(/[\\.\\n]|metro|servicio|bicicleta|autobuses|bus|autobús|acceso|también/i)[0].trim(),\n\t\t  null\n\t\t)"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "TIPO",
          "expression": "value",
          "columnName": "TIPO",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "/contenido/entidadesYorganismos/Universidades/ColegiosMayores",
                "l": "/contenido/entidadesYorganismos/Universidades/ColegiosMayores"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "columnName": "EQUIPAMIENTO",
    "expression": "value",
    "edits": [
      {
        "from": [
          "Tipo mixta."
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "Tipo mixto."
      }
    ],
    "description": "Editar celdas en masa en columna EQUIPAMIENTO"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "TIPO",
          "expression": "value",
          "columnName": "TIPO",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "/contenido/entidadesYorganismos/Universidades/ColegiosMayores",
                "l": "/contenido/entidadesYorganismos/Universidades/ColegiosMayores"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "columnName": "EQUIPAMIENTO",
    "expression": "value",
    "edits": [
      {
        "from": [
          "Tipo masculina."
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "Tipo masculino."
      }
    ],
    "description": "Editar celdas en masa en columna EQUIPAMIENTO"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "TIPO",
          "expression": "value",
          "columnName": "TIPO",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "/contenido/entidadesYorganismos/Universidades/ColegiosMayores",
                "l": "/contenido/entidadesYorganismos/Universidades/ColegiosMayores"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "columnName": "EQUIPAMIENTO",
    "expression": "value",
    "edits": [
      {
        "from": [
          "Tipo femenina."
        ],
        "fromBlank": false,
        "fromError": false,
        "to": "Tipo femenino."
      }
    ],
    "description": "Editar celdas en masa en columna EQUIPAMIENTO"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "TIPO",
          "expression": "value",
          "columnName": "TIPO",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "/contenido/entidadesYorganismos/Universidades/ColegiosMayores",
                "l": "/contenido/entidadesYorganismos/Universidades/ColegiosMayores"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "baseColumnName": "EQUIPAMIENTO",
    "expression": "grel:cells[\"EQUIPAMIENTO\"].value.replace(/Tipo\\s+(masculino|femenino|mixto)\\..*/, \"$1\"), \n   \"\")",
    "onError": "set-to-blank",
    "newColumnName": "generoAlumnos",
    "columnInsertIndex": 4,
    "description": "Crear la columna generoAlumnos en el índice 4 basada en la columna EQUIPAMIENTO usando la expresión grel:cells[\"EQUIPAMIENTO\"].value.replace(/Tipo\\s+(masculino|femenino|mixto)\\..*/, \"$1\"), \n   \"\")"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "TipoInstalacion",
          "expression": "value",
          "columnName": "TipoInstalacion",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "BibliotecasPublicas",
                "l": "BibliotecasPublicas"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "baseColumnName": "EQUIPAMIENTO",
    "expression": "grel:if(isBlank(cells[\"EQUIPAMIENTO\"].value), \n   \"no especifica\", if(or(cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"wifi gratuito\"),cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"zona wifi\")),\"sí\", \"no especifica\"))",
    "onError": "set-to-blank",
    "newColumnName": "tieneWifi",
    "columnInsertIndex": 4,
    "description": "Crear la columna tieneWifi en el índice 4 basada en la columna EQUIPAMIENTO usando la expresión grel:if(isBlank(cells[\"EQUIPAMIENTO\"].value), \n   \"no especifica\", if(or(cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"wifi gratuito\"),cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"zona wifi\")),\"sí\", \"no especifica\"))"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "TipoInstalacion",
          "expression": "value",
          "columnName": "TipoInstalacion",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "ParquesJardines",
                "l": "ParquesJardines"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "baseColumnName": "DESCRIPCION",
    "expression": "grel:value.match(/.*Superficie[:\\.]\\s*(?:Área de\\s*)?([0-9.,]+\\s*(m2|m²|ha|m&amp;sup2|hectáreas)).*/i)[0]",
    "onError": "set-to-blank",
    "newColumnName": "Superficie",
    "columnInsertIndex": 11,
    "description": "Crear la columna Superficie en el índice 11 basada en la columna DESCRIPCION usando la expresión grel:value.match(/.*Superficie[:\\.]\\s*(?:Área de\\s*)?([0-9.,]+\\s*(m2|m²|ha|m&amp;sup2|hectáreas)).*/i)[0]"
  },
  {
    "op": "core/mass-edit",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "TipoInstalacion",
          "expression": "value",
          "columnName": "TipoInstalacion",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "ParquesJardines",
                "l": "ParquesJardines"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "columnName": "Superficie",
    "expression": "value",
    "edits": [
      {
        "from": [],
        "fromBlank": true,
        "fromError": false,
        "to": "No especificado"
      }
    ],
    "description": "Editar celdas en masa en columna Superficie"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "TipoInstalacion",
          "expression": "value",
          "columnName": "TipoInstalacion",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "ParquesJardines",
                "l": "ParquesJardines"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "baseColumnName": "Superficie",
    "expression": "grel:if(value.match(\"No especificado\"), \"No especificado\", value.replace(/&amp;sup2/,\"²\").replace(\"hectáreas\",\"ha\").replace(\"m2\",\"m²\").replace(\".\",\"\").replace(/\\s+/,\" \").trim())",
    "onError": "set-to-blank",
    "newColumnName": "superficieLimpia",
    "columnInsertIndex": 12,
    "description": "Crear la columna superficieLimpia en el índice 12 basada en la columna Superficie usando la expresión grel:if(value.match(\"No especificado\"), \"No especificado\", value.replace(/&amp;sup2/,\"²\").replace(\"hectáreas\",\"ha\").replace(\"m2\",\"m²\").replace(\".\",\"\").replace(/\\s+/,\" \").trim())"
  },
  {
    "op": "core/column-removal",
    "columnName": "Superficie",
    "description": "Eliminar columna Superficie"
  },
  {
    "op": "core/column-addition",
    "engineConfig": {
      "facets": [
        {
          "type": "list",
          "name": "TipoInstalacion",
          "expression": "value",
          "columnName": "TipoInstalacion",
          "invert": false,
          "omitBlank": false,
          "omitError": false,
          "selection": [
            {
              "v": {
                "v": "ParquesJardines",
                "l": "ParquesJardines"
              }
            }
          ],
          "selectBlank": false,
          "selectError": false
        }
      ],
      "mode": "row-based"
    },
    "baseColumnName": "EQUIPAMIENTO",
    "expression": "grel:if(isBlank(cells[\"EQUIPAMIENTO\"].value), \"no especifica\", if(or(cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"instalaciones deportivas\"),cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"circuito deportivo\"),cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"zonas deportivas\"),cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"pista deportiva\"),cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"instalación deportiva\"),cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"polideportivos\")),\"sí\", \"no\"))",
    "onError": "set-to-blank",
    "newColumnName": "tieneInstalacionesDeportivas",
    "columnInsertIndex": 4,
    "description": "Crear la columna tieneInstalacionesDeportivas en el índice 4 basada en la columna EQUIPAMIENTO usando la expresión grel:if(isBlank(cells[\"EQUIPAMIENTO\"].value), \"no especifica\", if(or(cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"instalaciones deportivas\"),cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"circuito deportivo\"),cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"zonas deportivas\"),cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"pista deportiva\"),cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"instalación deportiva\"),cells[\"EQUIPAMIENTO\"].value.toLowercase().contains(\"polideportivos\")),\"sí\", \"no\"))"
  }
]